version: 1
applications:
  - appRoot: .
    frontend:
      phases:
        preBuild:
          commands:
            # Instala dependências
            - npm install
        build:
          commands:
            # Cria o build da aplicação Next.js
            - npm run build
      artifacts:
        # Diretório base onde o Next.js armazena os arquivos gerados
        baseDirectory: .next
        files:
          - '**/*'
      cache:
        paths:
          # Cache das dependências para builds mais rápidos
          - node_modules/**/*

    customHeaders:
      # Configurações de cabeçalhos HTTP
      - pattern: "**/*"
        headers:
          - key: Cache-Control
            value: "no-cache, no-store, must-revalidate"

    # Configuração de redirecionamentos para SSR e APIs
    redirects:
      - source: "/api/*"
        target: "/api/*"
        status: 200
      - source: "/app/*"
        target: "/app/*"
        status: 200
      - source: "/"
        target: "/index.html"
        status: 200
